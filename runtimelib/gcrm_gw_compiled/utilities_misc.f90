   MODULE utilities_misc

   USE kinds

   IMPLICIT NONE

   CONTAINS
!=======================================================================
!  BEGIN integer_to_string
!=======================================================================
   FUNCTION integer_to_string (strng_len,i) RESULT (strng)
!.......................................................................
!  INTENT IN
!.......................................................................
   INTEGER (KIND=int_kind) :: &
      strng_len,i
!.......................................................................
!  INTENT OUT
!.......................................................................
   CHARACTER (LEN=strng_len) :: &
      strng
!.......................................................................
!  LOCAL
!.......................................................................
   INTEGER (KIND=int_kind) :: &
      n
   CHARACTER (LEN=05) :: &
      fmt_strng(16)
!.:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:.

   fmt_strng = (/ &
      "(I01)","(I02)","(I03)","(I04)","(I05)","(I06)","(I07)","(I08)", &
      "(I09)","(I10)","(I11)","(I12)","(I13)","(I14)","(I15)","(I16)" /)

   WRITE (UNIT=strng,FMT=fmt_strng(strng_len)) i
   DO n = 1,strng_len; IF (strng(n:n)==' ') strng(n:n) = '0'; ENDDO

   END FUNCTION integer_to_string
!=======================================================================
!  END integer_to_string
!=======================================================================

!=======================================================================
!  BEGIN sort_real
!=======================================================================
   FUNCTION sort_real (lngth,lst1) RESULT (lst2)
!.......................................................................
!  INTENT IN
!.......................................................................
   INTEGER (KIND=int_kind) :: &
      lngth
   REAL (KIND=dbl_kind) :: &
      lst1(lngth)
!.......................................................................
!  INTENT IN
!.......................................................................
   REAL (KIND=dbl_kind) :: &
      lst2(lngth)
!.......................................................................
!  LOCAL
!.......................................................................
   INTEGER (KIND=int_kind) :: &
      iteration,n
   REAL (KIND=dbl_kind) :: &
      tmpry
!.:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:. .:.

   lst2(:) = lst1(:)

   DO iteration = 1,lngth-1
      DO n = 1,lngth-1
         IF (lst2(n+1)<lst2(n)) THEN
            tmpry = lst2(n); lst2(n) = lst2(n+1); lst2(n+1) = tmpry
         ENDIF
      ENDDO
   ENDDO

   END FUNCTION sort_real
!=======================================================================
!  END sort_real
!=======================================================================

   END MODULE utilities_misc
!cccccccc1ccccccccc2ccccccccc3ccccccccc4ccccccccc5cccgtgccc6ccccccccc7cc
