TODO: applyFillBlock is assuming all subgrids of g are the same size.
TODO: applyFillBlock is assuming all subgrids of g are the same size.
TODO: applyFillBlock is assuming all subgrids of g are the same size.
TODO: applyFillBlock is assuming all subgrids of g are the same size.
